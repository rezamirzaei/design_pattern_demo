<div class="pattern-card" id="pattern-abstract-factory" th:fragment="content">
    <div class="pattern-header">
        <div class="pattern-icon">ğŸ¢</div>
        <div class="pattern-info">
            <h3>Smart Home Ecosystem Factory</h3>
            <span class="pattern-badge badge-creational">Abstract Factory Pattern</span>
        </div>
    </div>
    <p class="pattern-desc">Create <strong>families of related devices</strong> for different smart home ecosystems. Each ecosystem (SmartThings, HomeKit, Google Home) has its own factory that produces compatible devices.</p>
    <div class="pattern-demo">
        <h4>ğŸ® Select Ecosystem to Create Device Suite</h4>
        <div class="ecosystem-selector">
            <button class="ecosystem-btn" onclick="AbstractFactory.create('SMARTTHINGS')">
                <div class="eco-icon">ğŸ”·</div>
                <div class="eco-info">
                    <div class="eco-name">Samsung SmartThings</div>
                    <div class="eco-desc">Creates: SmartThings Light, Thermostat, Sensor</div>
                </div>
                <div class="eco-devices">
                    <span>ğŸ’¡</span><span>ğŸŒ¡ï¸</span><span>ğŸ“¡</span>
                </div>
            </button>
            <button class="ecosystem-btn" onclick="AbstractFactory.create('HOMEKIT')">
                <div class="eco-icon">ğŸ</div>
                <div class="eco-info">
                    <div class="eco-name">Apple HomeKit</div>
                    <div class="eco-desc">Creates: HomeKit Light, Thermostat, Sensor</div>
                </div>
                <div class="eco-devices">
                    <span>ğŸ’¡</span><span>ğŸŒ¡ï¸</span><span>ğŸ“¡</span>
                </div>
            </button>
            <button class="ecosystem-btn" onclick="AbstractFactory.create('GOOGLE')">
                <div class="eco-icon">ğŸ”´</div>
                <div class="eco-info">
                    <div class="eco-name">Google Home</div>
                    <div class="eco-desc">Creates: Nest Light, Thermostat, Sensor</div>
                </div>
                <div class="eco-devices">
                    <span>ğŸ’¡</span><span>ğŸŒ¡ï¸</span><span>ğŸ“¡</span>
                </div>
            </button>
        </div>
        <div class="created-suite" id="af-created-suite" style="display:none;">
            <h5>ğŸ“¦ Created Device Suite</h5>
            <div class="suite-devices" id="af-suite-devices"></div>
        </div>
        <div class="pattern-explanation">
            <h5>ğŸ’¡ How Abstract Factory Works:</h5>
            <ul>
                <li><strong>Abstract Factory</strong> defines interface for creating device families</li>
                <li><strong>Concrete Factories</strong> (SmartThingsFactory, HomeKitFactory) create ecosystem-specific devices</li>
                <li>All devices from one factory are <strong>guaranteed compatible</strong></li>
                <li>Client code works with factories and products through abstract interfaces</li>
            </ul>
        </div>
    </div>
    <div class="result-area" id="abstract-factory-result"></div>
</div>
<script>
var AbstractFactory = {
    create: function(ecosystem) {
        var devices = {
            SMARTTHINGS: [{icon:'ğŸ’¡',name:'SmartThings Bulb',type:'Light'},{icon:'ğŸŒ¡ï¸',name:'SmartThings Thermostat',type:'Thermostat'},{icon:'ğŸ“¡',name:'SmartThings Motion',type:'Sensor'}],
            HOMEKIT: [{icon:'ğŸ’¡',name:'HomeKit Light',type:'Light'},{icon:'ğŸŒ¡ï¸',name:'HomeKit Climate',type:'Thermostat'},{icon:'ğŸ“¡',name:'HomeKit Sensor',type:'Sensor'}],
            GOOGLE: [{icon:'ğŸ’¡',name:'Nest Bulb',type:'Light'},{icon:'ğŸŒ¡ï¸',name:'Nest Thermostat',type:'Thermostat'},{icon:'ğŸ“¡',name:'Nest Detect',type:'Sensor'}]
        };
        var suite = devices[ecosystem] || devices.SMARTTHINGS;
        var container = document.getElementById('af-suite-devices');
        var html = suite.map(function(d) {
            return '<div class="suite-device"><span class="sd-icon">' + d.icon + '</span><span class="sd-name">' + d.name + '</span><span class="sd-type">' + d.type + '</span></div>';
        }).join('');
        container.innerHTML = html;
        document.getElementById('af-created-suite').style.display = 'block';
        fetch('/api/patterns/abstract-factory/create?ecosystem=' + ecosystem + '&location=Living Room', {method:'POST'})
            .then(function(r) { return r.json(); })
            .then(function(data) {
                PatternDemo.showResult('abstract-factory-result', ecosystem + ' Factory created device suite!\n\nEach device is guaranteed compatible with ' + ecosystem + ' ecosystem.\n\n' + JSON.stringify(data, null, 2));
                PatternDemo.toast(ecosystem + ' suite created', 'success');
            });
    }
};
</script>
<style>
.ecosystem-selector { display: flex; flex-direction: column; gap: 12px; }
.ecosystem-btn { display: flex; align-items: center; gap: 15px; padding: 18px; background: rgba(255,255,255,0.03); border: 2px solid rgba(255,255,255,0.1); border-radius: 15px; color: white; cursor: pointer; transition: all 0.3s; text-align: left; }
.ecosystem-btn:hover { background: rgba(0,210,255,0.1); border-color: rgba(0,210,255,0.4); transform: translateX(5px); }
.eco-icon { font-size: 2.5em; }
.eco-info { flex: 1; }
.eco-name { font-weight: 600; font-size: 1.1em; margin-bottom: 3px; }
.eco-desc { font-size: 0.85em; color: #888; }
.eco-devices { display: flex; gap: 8px; font-size: 1.5em; opacity: 0.6; }
.created-suite { margin-top: 20px; padding: 15px; background: rgba(0,210,255,0.1); border-radius: 12px; border: 1px solid rgba(0,210,255,0.3); }
.created-suite h5 { color: #00d2ff; margin-bottom: 12px; }
.suite-devices { display: flex; gap: 15px; flex-wrap: wrap; }
.suite-device { display: flex; flex-direction: column; align-items: center; padding: 15px 20px; background: rgba(0,0,0,0.2); border-radius: 10px; min-width: 120px; }
.sd-icon { font-size: 2em; margin-bottom: 8px; }
.sd-name { font-weight: 500; font-size: 0.9em; }
.sd-type { font-size: 0.75em; color: #888; }
</style>
</div>
