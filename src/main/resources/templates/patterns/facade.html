<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:fragment="content">
<div class="pattern-card" id="facade-pattern">
    <div class="pattern-header">
        <div class="pattern-icon">ğŸ¬</div>
        <div class="pattern-info">
            <h3>Smart Home Scenes</h3>
            <span class="pattern-badge structural">Facade Pattern</span>
        </div>
    </div>

    <p class="pattern-desc">
        One-click <strong>scenes</strong> that orchestrate multiple devices. The Facade hides the complexity
        of coordinating lights, thermostat, blinds, and more behind a simple interface.
    </p>

    <div class="pattern-demo">
        <h4>ğŸ® Activate a Scene</h4>

        <div class="scenes-grid">
            <button class="scene-card" onclick="Facade.activate('morning')">
                <div class="scene-icon">ğŸŒ…</div>
                <div class="scene-info">
                    <h5>Good Morning</h5>
                    <p>Lights on 70%, blinds open, thermostat 22Â°C, coffee maker starts</p>
                </div>
                <div class="scene-devices">
                    <span>ğŸ’¡</span><span>ğŸŒ¡ï¸</span><span>ğŸªŸ</span><span>â˜•</span>
                </div>
            </button>

            <button class="scene-card" onclick="Facade.activate('night')">
                <div class="scene-icon">ğŸŒ™</div>
                <div class="scene-info">
                    <h5>Good Night</h5>
                    <p>All lights off, doors locked, thermostat 18Â°C, cameras active</p>
                </div>
                <div class="scene-devices">
                    <span>ğŸ’¡</span><span>ğŸ”’</span><span>ğŸŒ¡ï¸</span><span>ğŸ“·</span>
                </div>
            </button>

            <button class="scene-card" onclick="Facade.activate('movie')">
                <div class="scene-icon">ğŸ¬</div>
                <div class="scene-info">
                    <h5>Movie Time</h5>
                    <p>Dim lights 20%, TV on, blinds closed, surround sound ready</p>
                </div>
                <div class="scene-devices">
                    <span>ğŸ’¡</span><span>ğŸ“º</span><span>ğŸªŸ</span><span>ğŸ”Š</span>
                </div>
            </button>

            <button class="scene-card" onclick="Facade.activate('party')">
                <div class="scene-icon">ğŸ‰</div>
                <div class="scene-info">
                    <h5>Party Mode</h5>
                    <p>Color lights, music system on, thermostat 20Â°C, disco mode</p>
                </div>
                <div class="scene-devices">
                    <span>ğŸŒˆ</span><span>ğŸµ</span><span>ğŸŒ¡ï¸</span><span>âœ¨</span>
                </div>
            </button>

            <button class="scene-card" onclick="Facade.activate('leave')">
                <div class="scene-icon">ğŸšª</div>
                <div class="scene-info">
                    <h5>Leaving Home</h5>
                    <p>All off, doors locked, security armed, thermostat eco mode</p>
                </div>
                <div class="scene-devices">
                    <span>ğŸ’¡</span><span>ğŸ”’</span><span>ğŸš¨</span><span>ğŸŒ¡ï¸</span>
                </div>
            </button>

            <button class="scene-card" onclick="Facade.activate('arrive')">
                <div class="scene-icon">ğŸ </div>
                <div class="scene-info">
                    <h5>Welcome Home</h5>
                    <p>Lights on, door unlocks, thermostat comfort mode, music plays</p>
                </div>
                <div class="scene-devices">
                    <span>ğŸ’¡</span><span>ğŸ”“</span><span>ğŸŒ¡ï¸</span><span>ğŸµ</span>
                </div>
            </button>
        </div>

        <div class="behind-scenes">
            <h5>ğŸ‘ï¸ What Happens Behind the Scenes</h5>
            <div class="operations-list" id="facade-operations">
                <p class="placeholder">Click a scene to see all the operations the Facade coordinates...</p>
            </div>
        </div>

        <div class="pattern-explanation">
            <h5>ğŸ’¡ How Facade Works Here:</h5>
            <ul>
                <li>Each scene is a <strong>single method call</strong> to the Facade</li>
                <li>Facade internally calls multiple subsystems: LightingSystem, SecuritySystem, ClimateSystem, etc.</li>
                <li>Client doesn't need to know about device protocols or coordination logic</li>
                <li>Adding new scenes only requires new Facade methods, not client changes</li>
            </ul>
        </div>
    </div>

    <div class="result-area" id="facade-result"></div>
</div>

<script>
var Facade = {
    sceneOperations: {
        morning: [
            { device: 'ğŸ’¡ Living Room Light', action: 'Set brightness to 70%' },
            { device: 'ğŸ’¡ Kitchen Light', action: 'Turn ON' },
            { device: 'ğŸªŸ All Blinds', action: 'Open to 100%' },
            { device: 'ğŸŒ¡ï¸ Thermostat', action: 'Set to 22Â°C' },
            { device: 'â˜• Coffee Maker', action: 'Start brewing' },
            { device: 'ğŸ“» Kitchen Speaker', action: 'Play morning playlist' }
        ],
        night: [
            { device: 'ğŸ’¡ All Lights', action: 'Turn OFF' },
            { device: 'ğŸ”’ Front Door', action: 'Lock' },
            { device: 'ğŸ”’ Back Door', action: 'Lock' },
            { device: 'ğŸŒ¡ï¸ Thermostat', action: 'Set to 18Â°C (sleep mode)' },
            { device: 'ğŸ“· Security Cameras', action: 'Enable night vision' },
            { device: 'ğŸš¨ Alarm System', action: 'Arm perimeter sensors' }
        ],
        movie: [
            { device: 'ğŸ’¡ Living Room Light', action: 'Dim to 20%' },
            { device: 'ğŸªŸ Living Room Blinds', action: 'Close' },
            { device: 'ğŸ“º TV', action: 'Turn ON, switch to HDMI 1' },
            { device: 'ğŸ”Š Surround Sound', action: 'Enable movie mode' },
            { device: 'ğŸŒ¡ï¸ Thermostat', action: 'Set to 21Â°C' },
            { device: 'ğŸ“± Phones', action: 'Enable Do Not Disturb' }
        ],
        party: [
            { device: 'ğŸŒˆ Smart Lights', action: 'Color cycle mode' },
            { device: 'ğŸµ Music System', action: 'Party playlist, volume 70%' },
            { device: 'ğŸŒ¡ï¸ Thermostat', action: 'Set to 20Â°C' },
            { device: 'âœ¨ Disco Ball', action: 'Activate' },
            { device: 'ğŸšª Doorbell', action: 'Enable party mode notifications' }
        ],
        leave: [
            { device: 'ğŸ’¡ All Lights', action: 'Turn OFF' },
            { device: 'ğŸ”’ All Doors', action: 'Lock' },
            { device: 'ğŸªŸ All Blinds', action: 'Close' },
            { device: 'ğŸŒ¡ï¸ Thermostat', action: 'Eco mode (16Â°C)' },
            { device: 'ğŸš¨ Security System', action: 'ARM all zones' },
            { device: 'ğŸ“· Cameras', action: 'Enable motion detection alerts' }
        ],
        arrive: [
            { device: 'ğŸ”“ Front Door', action: 'Unlock' },
            { device: 'ğŸ’¡ Hallway Light', action: 'Turn ON' },
            { device: 'ğŸ’¡ Living Room Light', action: 'Set to 60%' },
            { device: 'ğŸŒ¡ï¸ Thermostat', action: 'Comfort mode (22Â°C)' },
            { device: 'ğŸµ Speaker', action: 'Play welcome music' },
            { device: 'ğŸš¨ Security System', action: 'Disarm' }
        ]
    },

    activate: function(scene) {
        // Show operations
        var ops = this.sceneOperations[scene] || [];
        var html = '<div class="ops-header">Scene "' + scene + '" executes ' + ops.length + ' operations:</div>';
        ops.forEach(function(op, i) {
            html += '<div class="op-item">';
            html += '<span class="op-num">' + (i + 1) + '</span>';
            html += '<span class="op-device">' + op.device + '</span>';
            html += '<span class="op-arrow">â†’</span>';
            html += '<span class="op-action">' + op.action + '</span>';
            html += '</div>';
        });
        document.getElementById('facade-operations').innerHTML = html;

        // Make API call
        fetch('/api/patterns/facade/scene/' + scene, { method: 'POST' })
            .then(function(r) { return r.json(); })
            .then(function(data) {
                PatternDemo.showResult('facade-result',
                    'âœ… Scene "' + scene + '" activated!\n\n' +
                    'The Facade coordinated ' + ops.length + ' device operations with a single call.\n' +
                    'Client code: facade.activateScene("' + scene + '")\n\n' +
                    JSON.stringify(data, null, 2)
                );
                PatternDemo.toast('Scene: ' + scene, 'success');
            });
    }
};
</script>

<style>
.scenes-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 25px; }
.scene-card { display: flex; flex-direction: column; padding: 20px; background: rgba(255,255,255,0.03); border: 2px solid rgba(255,255,255,0.1); border-radius: 15px; color: white; cursor: pointer; transition: all 0.3s; text-align: left; }
.scene-card:hover { background: rgba(0,210,255,0.1); border-color: rgba(0,210,255,0.5); transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0,210,255,0.15); }
.scene-icon { font-size: 2.5em; margin-bottom: 10px; }
.scene-info h5 { margin: 0 0 5px 0; font-size: 1.1em; }
.scene-info p { margin: 0; font-size: 0.8em; color: #888; line-height: 1.4; }
.scene-devices { display: flex; gap: 8px; margin-top: 15px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.1); }
.scene-devices span { font-size: 1.2em; opacity: 0.7; }
.behind-scenes { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 20px; margin-top: 20px; }
.behind-scenes h5 { color: #00d2ff; margin-bottom: 15px; }
.operations-list .placeholder { color: #666; font-style: italic; }
.ops-header { color: #00d2ff; margin-bottom: 12px; font-weight: 500; }
.op-item { display: flex; align-items: center; gap: 10px; padding: 8px 12px; background: rgba(255,255,255,0.03); border-radius: 8px; margin-bottom: 6px; }
.op-num { background: rgba(0,210,255,0.2); color: #00d2ff; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.8em; font-weight: bold; }
.op-device { color: #fff; min-width: 180px; }
.op-arrow { color: #666; }
.op-action { color: #7ee787; }

@media (max-width: 900px) { .scenes-grid { grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 600px) { .scenes-grid { grid-template-columns: 1fr; } }
</style>
</html>
