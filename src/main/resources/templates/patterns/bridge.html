<div class="pattern-card" id="pattern-bridge" th:fragment="content">
    <div class="pattern-header">
        <div class="pattern-icon">üåâ</div>
        <div class="pattern-info">
            <h3>Remote Control Bridge</h3>
            <span class="pattern-badge badge-structural">Bridge Pattern</span>
        </div>
    </div>
    <p class="pattern-desc">Decouple <strong>remote controls</strong> from <strong>devices</strong>. Any remote can control any device - they're connected through a bridge that separates abstraction from implementation.</p>
    <div class="pattern-demo">
        <h4>üéÆ Mix & Match Remotes with Devices</h4>
        <div class="bridge-workspace">
            <div class="bridge-column">
                <h5>üì± Select Remote (Abstraction)</h5>
                <div class="remote-list">
                    <button class="remote-btn active" onclick="Bridge.selectRemote(this,'basic')">
                        <span class="rb-icon">üì±</span>
                        <span class="rb-name">Basic Remote</span>
                        <span class="rb-desc">On/Off only</span>
                    </button>
                    <button class="remote-btn" onclick="Bridge.selectRemote(this,'advanced')">
                        <span class="rb-icon">üì≤</span>
                        <span class="rb-name">Advanced Remote</span>
                        <span class="rb-desc">On/Off + Dimmer</span>
                    </button>
                    <button class="remote-btn" onclick="Bridge.selectRemote(this,'touch')">
                        <span class="rb-icon">‚úã</span>
                        <span class="rb-name">Touch Panel</span>
                        <span class="rb-desc">Full control + scenes</span>
                    </button>
                </div>
            </div>
            <div class="bridge-connector">
                <div class="bridge-icon">üåâ</div>
                <div class="bridge-label">Bridge</div>
            </div>
            <div class="bridge-column">
                <h5>üè† Select Device (Implementation)</h5>
                <div class="device-btn-list">
                    <button class="device-btn active" onclick="Bridge.selectDevice(this,'light')">
                        <span class="db-icon">üí°</span>
                        <span class="db-name">Smart Light</span>
                    </button>
                    <button class="device-btn" onclick="Bridge.selectDevice(this,'tv')">
                        <span class="db-icon">üì∫</span>
                        <span class="db-name">Smart TV</span>
                    </button>
                    <button class="device-btn" onclick="Bridge.selectDevice(this,'speaker')">
                        <span class="db-icon">üîä</span>
                        <span class="db-name">Speaker</span>
                    </button>
                    <button class="device-btn" onclick="Bridge.selectDevice(this,'thermostat')">
                        <span class="db-icon">üå°Ô∏è</span>
                        <span class="db-name">Thermostat</span>
                    </button>
                </div>
            </div>
        </div>
        <div class="bridge-actions">
            <h5>üéØ Available Actions</h5>
            <div class="action-btns" id="bridge-actions">
                <button class="action-btn" onclick="Bridge.execute('on')">‚ö° Turn On</button>
                <button class="action-btn" onclick="Bridge.execute('off')">üîå Turn Off</button>
            </div>
        </div>
        <div class="pattern-explanation">
            <h5>üí° How Bridge Works:</h5>
            <ul>
                <li><strong>Abstraction</strong> (Remote) defines high-level control interface</li>
                <li><strong>Implementation</strong> (Device) defines device-specific operations</li>
                <li>Bridge connects them - remote doesn't know device details</li>
                <li>Can add new remotes OR devices independently</li>
            </ul>
        </div>
    </div>
    <div class="result-area" id="bridge-result"></div>
</div>
<script>
var Bridge = {
    selectedRemote: 'basic',
    selectedDevice: 'light',
    selectRemote: function(btn, remote) {
        document.querySelectorAll('.remote-btn').forEach(function(b) { b.classList.remove('active'); });
        btn.classList.add('active');
        this.selectedRemote = remote;
        this.updateActions();
    },
    selectDevice: function(btn, device) {
        document.querySelectorAll('.device-btn').forEach(function(b) { b.classList.remove('active'); });
        btn.classList.add('active');
        this.selectedDevice = device;
    },
    updateActions: function() {
        var actions = {
            basic: '<button class="action-btn" onclick="Bridge.execute(\'on\')">‚ö° On</button><button class="action-btn" onclick="Bridge.execute(\'off\')">üîå Off</button>',
            advanced: '<button class="action-btn" onclick="Bridge.execute(\'on\')">‚ö° On</button><button class="action-btn" onclick="Bridge.execute(\'off\')">üîå Off</button><button class="action-btn" onclick="Bridge.execute(\'dim\')">üîÖ Dim</button><button class="action-btn" onclick="Bridge.execute(\'bright\')">üîÜ Bright</button>',
            touch: '<button class="action-btn" onclick="Bridge.execute(\'on\')">‚ö° On</button><button class="action-btn" onclick="Bridge.execute(\'off\')">üîå Off</button><button class="action-btn" onclick="Bridge.execute(\'dim\')">üîÖ Dim</button><button class="action-btn" onclick="Bridge.execute(\'scene\')">üé¨ Scene</button><button class="action-btn" onclick="Bridge.execute(\'schedule\')">‚è∞ Schedule</button>'
        };
        document.getElementById('bridge-actions').innerHTML = actions[this.selectedRemote] || actions.basic;
    },
    execute: function(action) {
        var remoteNames = {basic:'Basic Remote',advanced:'Advanced Remote',touch:'Touch Panel'};
        var deviceNames = {light:'Smart Light',tv:'Smart TV',speaker:'Speaker',thermostat:'Thermostat'};
        fetch('/api/patterns/bridge/control?remote=' + this.selectedRemote + '&device=' + this.selectedDevice + '&action=' + action, {method:'POST'})
            .then(function(r) { return r.json(); })
            .then(function(data) {
                PatternDemo.showResult('bridge-result', remoteNames[Bridge.selectedRemote] + ' ‚Üí ' + deviceNames[Bridge.selectedDevice] + '\n\nAction: ' + action.toUpperCase() + '\n\nThe Bridge pattern connected the remote abstraction to the device implementation.\n\n' + JSON.stringify(data, null, 2));
                PatternDemo.toast(action + ' ‚Üí ' + deviceNames[Bridge.selectedDevice], 'success');
            });
    }
};
</script>
<style>
.bridge-workspace { display: flex; align-items: center; gap: 20px; margin-bottom: 25px; }
.bridge-column { flex: 1; }
.bridge-column h5 { color: #00d2ff; margin-bottom: 12px; font-size: 0.9em; }
.remote-list, .device-btn-list { display: flex; flex-direction: column; gap: 10px; }
.remote-btn, .device-btn { display: flex; align-items: center; gap: 12px; padding: 12px 15px; background: rgba(255,255,255,0.03); border: 2px solid rgba(255,255,255,0.1); border-radius: 10px; color: white; cursor: pointer; transition: all 0.3s; text-align: left; }
.remote-btn:hover, .device-btn:hover { background: rgba(0,210,255,0.1); border-color: rgba(0,210,255,0.3); }
.remote-btn.active, .device-btn.active { background: rgba(0,210,255,0.2); border-color: #00d2ff; }
.rb-icon, .db-icon { font-size: 1.5em; }
.rb-name, .db-name { font-weight: 500; }
.rb-desc { font-size: 0.75em; color: #888; margin-left: auto; }
.bridge-connector { display: flex; flex-direction: column; align-items: center; padding: 20px; }
.bridge-icon { font-size: 2.5em; }
.bridge-label { font-size: 0.8em; color: #00d2ff; margin-top: 5px; }
.bridge-actions { padding: 15px; background: rgba(0,0,0,0.2); border-radius: 12px; }
.bridge-actions h5 { color: #888; margin-bottom: 12px; font-size: 0.9em; }
.action-btns { display: flex; flex-wrap: wrap; gap: 10px; }
.action-btn { padding: 10px 18px; background: linear-gradient(90deg, #00d2ff, #3a7bd5); border: none; border-radius: 8px; color: white; cursor: pointer; transition: all 0.3s; }
.action-btn:hover { transform: scale(1.05); }
</style>
</div>
