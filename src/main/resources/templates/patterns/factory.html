<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:fragment="content">
<div class="pattern-card" id="factory-pattern">
    <div class="pattern-header">
        <div class="pattern-icon">üè≠</div>
        <div class="pattern-info">
            <h3>Device Factory</h3>
            <span class="pattern-badge creational">Factory Method Pattern</span>
        </div>
    </div>

    <p class="pattern-desc">
        Create different types of smart devices without knowing their exact implementation classes.
        The factory decides which device class to instantiate based on the type you request.
    </p>

    <div class="pattern-demo">
        <h4>üéÆ Create New Smart Device</h4>

        <div class="device-creator">
            <div class="creator-form">
                <div class="form-group">
                    <label>Device Type</label>
                    <div class="device-type-selector">
                        <button class="type-btn active" data-type="LIGHT" onclick="Factory.selectType(this, 'LIGHT')">
                            <span class="type-icon">üí°</span>
                            <span>Light</span>
                        </button>
                        <button class="type-btn" data-type="THERMOSTAT" onclick="Factory.selectType(this, 'THERMOSTAT')">
                            <span class="type-icon">üå°Ô∏è</span>
                            <span>Thermostat</span>
                        </button>
                        <button class="type-btn" data-type="CAMERA" onclick="Factory.selectType(this, 'CAMERA')">
                            <span class="type-icon">üì∑</span>
                            <span>Camera</span>
                        </button>
                        <button class="type-btn" data-type="LOCK" onclick="Factory.selectType(this, 'LOCK')">
                            <span class="type-icon">üîí</span>
                            <span>Lock</span>
                        </button>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Device Name</label>
                        <input type="text" id="factory-device-name" class="form-input" placeholder="e.g., Kitchen Light" value="New Device">
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" id="factory-device-location" class="form-input" placeholder="e.g., Living Room" value="Living Room">
                    </div>
                </div>

                <button class="btn-create" onclick="Factory.createDevice()">
                    <span class="btn-icon">‚ûï</span>
                    Create Device
                </button>
            </div>

            <div class="quick-create">
                <h5>‚ö° Quick Create</h5>
                <button class="quick-btn" onclick="Factory.quickCreate('LIGHT', 'Kitchen Light', 'Kitchen')">
                    üí° Kitchen Light
                </button>
                <button class="quick-btn" onclick="Factory.quickCreate('THERMOSTAT', 'Living Thermostat', 'Living Room')">
                    üå°Ô∏è Living Thermostat
                </button>
                <button class="quick-btn" onclick="Factory.quickCreate('CAMERA', 'Front Door Cam', 'Entrance')">
                    üì∑ Front Door Cam
                </button>
                <button class="quick-btn" onclick="Factory.quickCreate('LOCK', 'Main Door Lock', 'Entrance')">
                    üîí Main Door Lock
                </button>
            </div>
        </div>

        <div class="pattern-explanation">
            <h5>üí° How Factory Method Works Here:</h5>
            <ul>
                <li>You request a device by TYPE (LIGHT, THERMOSTAT, etc.)</li>
                <li>The factory creates the correct concrete class (SmartLight, SmartThermostat, etc.)</li>
                <li>You don't need to know how each device is constructed</li>
                <li>Adding new device types only requires adding new factory methods</li>
            </ul>
        </div>
    </div>

    <div class="result-area" id="factory-result"></div>
</div>

<script>
var Factory = {
    selectedType: 'LIGHT',

    selectType: function(btn, type) {
        document.querySelectorAll('.type-btn').forEach(function(b) { b.classList.remove('active'); });
        btn.classList.add('active');
        this.selectedType = type;
    },

    createDevice: function() {
        var name = document.getElementById('factory-device-name').value;
        var location = document.getElementById('factory-device-location').value;
        this.quickCreate(this.selectedType, name, location);
    },

    quickCreate: function(type, name, location) {
        fetch('/api/patterns/factory/create?type=' + type + '&name=' + encodeURIComponent(name) + '&location=' + encodeURIComponent(location), { method: 'POST' })
            .then(function(r) { return r.json(); })
            .then(function(data) {
                PatternDemo.showResult('factory-result',
                    'Created ' + type + ' device!\n\n' +
                    'Factory created: ' + (data.name || name) + '\n' +
                    'Location: ' + (data.location || location) + '\n' +
                    'Device ID: ' + (data.id || 'generated') + '\n\n' +
                    'The factory automatically instantiated the correct device class.'
                );
                PatternDemo.toast('Created: ' + name, 'success');
            });
    }
};
</script>

<style>
.device-type-selector { display: flex; gap: 10px; margin-top: 10px; }
.type-btn { display: flex; flex-direction: column; align-items: center; padding: 15px 20px; background: rgba(255,255,255,0.05); border: 2px solid rgba(255,255,255,0.1); border-radius: 12px; color: white; cursor: pointer; transition: all 0.3s; }
.type-btn:hover { background: rgba(0,210,255,0.1); border-color: rgba(0,210,255,0.3); }
.type-btn.active { background: rgba(0,210,255,0.2); border-color: #00d2ff; }
.type-icon { font-size: 1.5em; margin-bottom: 5px; }
.form-row { display: flex; gap: 15px; }
.form-group { flex: 1; margin-bottom: 15px; }
.form-group label { display: block; margin-bottom: 5px; color: #888; font-size: 0.9em; }
.btn-create { width: 100%; padding: 12px; background: linear-gradient(90deg, #00d2ff, #3a7bd5); border: none; border-radius: 8px; color: white; font-size: 1em; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; }
.btn-create:hover { transform: scale(1.02); }
.quick-create { margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); }
.quick-create h5 { margin-bottom: 10px; color: #888; }
.quick-btn { padding: 8px 15px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; color: #ccc; cursor: pointer; margin: 3px; transition: all 0.3s; }
.quick-btn:hover { background: rgba(0,210,255,0.1); border-color: rgba(0,210,255,0.3); }
</style>
</html>
