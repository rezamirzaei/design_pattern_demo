<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Home - Devices</title>
    <link rel="stylesheet" th:href="@{/css/patterns-pro.css}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-brand">üè† SmartHome OS</div>
        <div class="main-links">
            <a href="/ui/devices" class="nav-link active">Devices</a>
            <a href="/ui/rooms" class="nav-link">Rooms</a>
            <a href="/ui/scenes" class="nav-link">Scenes</a>
            <a href="/ui/rules" class="nav-link">Rules</a>
            <a href="/?tab=patterns" class="nav-link">Patterns</a>
        </div>
    </nav>

<div class="container">
    <header>
        <h1>üì± Devices</h1>
        <p class="subtitle">Manage devices and run Factory Method creation from the UI</p>
    </header>

    <div class="section">
        <h2 class="section-title">‚ûï Create Device (Factory Method)</h2>
        <div class="card">
            <form data-api-endpoint="/patterns/factory/create" data-api-method="POST" data-refresh="true">
                <div class="form-row">
                    <div>
                        <label for="type">Type</label>
                        <select id="type" name="type">
                            <option value="LIGHT">LIGHT</option>
                            <option value="THERMOSTAT">THERMOSTAT</option>
                            <option value="CAMERA">CAMERA</option>
                            <option value="LOCK">LOCK</option>
                        </select>
                    </div>
                    <div>
                        <label for="location">Location</label>
                        <input id="location" name="location" placeholder="Living Room" required>
                    </div>
                </div>
                <label for="name">Name</label>
                <input id="name" name="name" placeholder="My Device" required>
                <button class="btn btn-primary" type="submit">Create</button>
            </form>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title">üìã Current Devices</h2>
        <div class="grid">
            <div class="card" th:each="device : ${devices}" th:attr="data-device-id=${device.id}">
                <div class="card-header">
                    <span class="card-title" th:text="${device.info}">Device Name</span>
                    <span class="device-status"
                          th:class="${device.isOn} ? 'device-status status-on' : 'device-status status-off'"
                          th:text="${device.isOn} ? 'ON' : 'OFF'">OFF</span>
                </div>
                <div class="power-indicator">
                    <span>‚ö° Power:</span>
                    <span class="value" th:text="${device.power + 'W'}">0W</span>
                </div>
                <div style="margin-top: 12px;">
                    <button class="btn btn-primary device-control-btn" type="button" data-action="on" th:attr="data-device-id=${device.id}">Turn On</button>
                    <button class="btn btn-secondary device-control-btn" type="button" data-action="off" th:attr="data-device-id=${device.id}">Turn Off</button>
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title">üìã Output Log</h2>
        <div class="output-area">
            <pre id="output">Actions will appear here‚Ä¶</pre>
        </div>
    </div>
</div>

<script th:src="@{/js/app.js}"></script>
</body>
</html>
